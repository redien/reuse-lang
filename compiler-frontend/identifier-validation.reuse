
(def identifier-is-reserved? (identifier)
     (string-equal? (string-substring 0 3 (symbol-name identifier)) (data-sparkle)))

(def validate-identifier (identifier)
     (match (identifier-is-reserved? identifier)
            True   (result-error (ErrorReservedIdentifier (symbol-name identifier)
                                                          (symbol-source-reference identifier)
                                                          (symbol-range identifier)))
            False  (result-lift identifier)))

(def validate-reserved-identifiers (definitions)
     (result-flatmap (. result-concat (list-map (over-definition-expressions (over-identifiers validate-identifier)))) definitions))
